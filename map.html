<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>A Grand Tour - Route Map</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: 8px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 13px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            max-width: 280px;
        }
        #info h2 { margin: 0 0 5px 0; font-size: 16px; }
        #info p { margin: 5px 0; color: #666; }
    </style>
</head>
<body>
<div id="map"></div>
<div id="info">
    <h2>A Grand Tour</h2>
    <p>15 years | 200,000 km | 100+ countries</p>
    <p>Feb 2027 â€“ Aug 2042</p>
</div>

<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoiamx4cTAiLCJhIjoiY21qd2QwOGRpNXVuNzNnb2txNmdkemd2ZyJ9.JpfheNv0aknnk-pbhNOGQg';

const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/light-v11',
    center: [40, 20],
    zoom: 1.5
});

map.on('load', async () => {
    // Load visited countries from data file
    const visitedCountryCodes = await fetch('data/visited-countries.json').then(r => r.json());
    // Add country boundaries source
    map.addSource('countries', {
        type: 'vector',
        url: 'mapbox://mapbox.country-boundaries-v1'
    });

    // Add country fill layer - green for visited, gray for not
    map.addLayer({
        id: 'country-fills',
        type: 'fill',
        source: 'countries',
        'source-layer': 'country_boundaries',
        filter: [
            'all',
            ['==', ['get', 'disputed'], 'false'],
            ['any',
                ['==', 'all', ['get', 'worldview']],
                ['in', 'US', ['get', 'worldview']]
            ]
        ],
        paint: {
            'fill-color': [
                'case',
                ['in', ['get', 'iso_3166_1'], ['literal', visitedCountryCodes]],
                'rgba(39, 174, 96, 0.15)',
                'rgba(200, 200, 200, 0.05)'
            ],
            'fill-opacity': 1
        }
    }, 'admin-1-boundary-bg');
});

map.addControl(new mapboxgl.NavigationControl());
</script>
</body>
</html>
